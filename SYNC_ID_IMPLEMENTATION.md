# üîó –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø –ù–ê–î–ï–ñ–ù–û–ô –°–ò–ù–•–†–û–ù–ò–ó–ê–¶–ò–ò –ß–ï–†–ï–ó sync_product_id

## üìã –û–ë–ó–û–†

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –Ω–∞–¥–µ–∂–Ω–∞—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Ç–æ–≤–∞—Ä–æ–≤ –º–µ–∂–¥—É –æ—Å–Ω–æ–≤–Ω—ã–º –º–∞–≥–∞–∑–∏–Ω–æ–º –∏ –º–∞–≥–∞–∑–∏–Ω–∞–º–∏ –ø–æ–¥–∫–ª—é—á–µ–Ω–Ω—ã—Ö –±–æ—Ç–æ–≤ —á–µ—Ä–µ–∑ –ø–æ–ª–µ `sync_product_id` –≤–º–µ—Å—Ç–æ –Ω–µ–Ω–∞–¥–µ–∂–Ω–æ–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –ø–æ –∏–º–µ–Ω–∏ –∏ —Ü–µ–Ω–µ.

---

## ‚úÖ –í–´–ü–û–õ–ù–ï–ù–ù–´–ï –ò–ó–ú–ï–ù–ï–ù–ò–Ø

### 1. –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `sync_product_id` –≤ –º–æ–¥–µ–ª—å Product

**–§–∞–π–ª:** `backend/app/db/models.py`

```python
sync_product_id = Column(Integer, ForeignKey("products.id"), nullable=True, index=True)
```

**–û–ø–∏—Å–∞–Ω–∏–µ:**
- –°–≤—è–∑—ã–≤–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –º–µ–∂–¥—É –º–∞–≥–∞–∑–∏–Ω–∞–º–∏
- –î–ª—è —Ç–æ–≤–∞—Ä–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ (bot_id=None): `sync_product_id = id` (—Å–∞–º –Ω–∞ —Å–µ–±—è)
- –î–ª—è —Ç–æ–≤–∞—Ä–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ –±–æ—Ç–∞: `sync_product_id = id` –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ

---

### 2. –°–æ–∑–¥–∞–Ω–∞ –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—è

**–§–∞–π–ª:** `backend/migrate_add_sync_product_id.py`

**–§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å:**
- –î–æ–±–∞–≤–ª—è–µ—Ç –ø–æ–ª–µ `sync_product_id` –≤ —Ç–∞–±–ª–∏—Ü—É `products`
- –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `sync_product_id = id` –¥–ª—è –≤—Å–µ—Ö —Ç–æ–≤–∞—Ä–æ–≤ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ
- –°–≤—è–∑—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã –≤ –º–∞–≥–∞–∑–∏–Ω–∞—Ö –±–æ—Ç–æ–≤ —Å –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–º–∏ —Ç–æ–≤–∞—Ä–∞–º–∏ –ø–æ –∏–º–µ–Ω–∏ –∏ —Ü–µ–Ω–µ (–¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö)
- –°–æ–∑–¥–∞–µ—Ç –∏–Ω–¥–µ–∫—Å –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞

**–ó–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–∏:**
```bash
cd backend
python migrate_add_sync_product_id.py
```

---

### 3. –ü–µ—Ä–µ–ø–∏—Å–∞–Ω—ã —Ñ—É–Ω–∫—Ü–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

**–§–∞–π–ª:** `backend/app/routers/products.py`

#### –û—Å–Ω–æ–≤–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è:

1. **`sync_product_to_all_bots()`** - –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `sync_product_id` –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
   - –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `sync_product_id` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–ø–∏–π
   - –ü—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏: –∏—â–µ—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ `sync_product_id` –≤–º–µ—Å—Ç–æ –∏–º–µ–Ω–∏ –∏ —Ü–µ–Ω—ã
   - –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏: —É–¥–∞–ª—è–µ—Ç –≤—Å–µ —Ç–æ–≤–∞—Ä—ã —Å —Ç–∞–∫–∏–º –∂–µ `sync_product_id`

2. **`sync_product_to_all_bots_with_rename()`** - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `sync_product_id`
   - –ò—â–µ—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ `sync_product_id` –≤–º–µ—Å—Ç–æ —Å—Ç–∞—Ä–æ–≥–æ –∏–º–µ–Ω–∏
   - Fallback –Ω–∞ –ø–æ–∏—Å–∫ –ø–æ —Å—Ç–∞—Ä–æ–º—É –∏–º–µ–Ω–∏ –∏ —Ü–µ–Ω–µ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

3. **`create_product()`** - —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `sync_product_id` –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏
   - –î–ª—è —Ç–æ–≤–∞—Ä–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ: `sync_product_id = id` (–ø–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è ID)
   - –î–ª—è —Ç–æ–≤–∞—Ä–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ –±–æ—Ç–∞: `sync_product_id` —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

4. **`get_products()`** - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ä–µ–∑–µ—Ä–≤–∞—Ü–∏–π
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç `sync_product_id` –¥–ª—è –ø–æ–∏—Å–∫–∞ –≤—Å–µ—Ö —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –∫–æ–ø–∏–π
   - Fallback –Ω–∞ –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏ —Ü–µ–Ω–µ –¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

5. **`sync_all_products()`** - –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–ª—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è `sync_product_id`
   - –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `sync_product_id` –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤
   - –°–≤—è–∑—ã–≤–∞–µ—Ç —Ç–æ–≤–∞—Ä—ã –ø–æ `sync_product_id` –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

---

## üîß –õ–û–ì–ò–ö–ê –†–ê–ë–û–¢–´

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ (bot_id=None)

1. –°–æ–∑–¥–∞–µ—Ç—Å—è —Ç–æ–≤–∞—Ä —Å `sync_product_id = None`
2. –ü–æ—Å–ª–µ –ø–æ–ª—É—á–µ–Ω–∏—è ID: `sync_product_id = id` (—Å–∞–º –Ω–∞ —Å–µ–±—è)
3. –ü—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –≤ –º–∞–≥–∞–∑–∏–Ω—ã –±–æ—Ç–æ–≤: —Å–æ–∑–¥–∞—é—Ç—Å—è –∫–æ–ø–∏–∏ —Å `sync_product_id = id` –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –º–∞–≥–∞–∑–∏–Ω–µ –±–æ—Ç–∞ (bot_id != None)

1. –°–æ–∑–¥–∞–µ—Ç—Å—è —Ç–æ–≤–∞—Ä —Å `sync_product_id = None`
2. –ü—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏:
   - –ò—â–µ—Ç—Å—è –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω—ã–π —Ç–æ–≤–∞—Ä –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ
   - –ï—Å–ª–∏ –Ω–∞–π–¥–µ–Ω: `sync_product_id = id` –æ—Ä–∏–≥–∏–Ω–∞–ª—å–Ω–æ–≥–æ —Ç–æ–≤–∞—Ä–∞
   - –ï—Å–ª–∏ –Ω–µ –Ω–∞–π–¥–µ–Ω: —Å–æ–∑–¥–∞–µ—Ç—Å—è –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ, –∑–∞—Ç–µ–º `sync_product_id = id` –Ω–æ–≤–æ–≥–æ —Ç–æ–≤–∞—Ä–∞

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞

1. –ù–∞—Ö–æ–¥–∏—Ç—Å—è —Ç–æ–≤–∞—Ä –ø–æ `sync_product_id` (–Ω–∞–¥–µ–∂–Ω—ã–π —Å–ø–æ—Å–æ–±)
2. Fallback: –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏ —Ü–µ–Ω–µ (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)
3. –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã —Å —Ç–∞–∫–∏–º –∂–µ `sync_product_id`

### –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞

1. –ù–∞—Ö–æ–¥—è—Ç—Å—è –≤—Å–µ —Ç–æ–≤–∞—Ä—ã —Å —Ç–∞–∫–∏–º –∂–µ `sync_product_id`
2. –£–¥–∞–ª—è—é—Ç—Å—è –≤—Å–µ —Å–≤—è–∑–∞–Ω–Ω—ã–µ —Ç–æ–≤–∞—Ä—ã –≤–æ –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö
3. Fallback: —É–¥–∞–ª–µ–Ω–∏–µ –ø–æ –∏–º–µ–Ω–∏ (–¥–ª—è –æ–±—Ä–∞—Ç–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏)

### –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞

1. –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `sync_product_id` –¥–ª—è –ø–æ–∏—Å–∫–∞ —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤
2. –û–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∏–º—è –≤–æ –≤—Å–µ—Ö —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Ç–æ–≤–∞—Ä–∞—Ö
3. Fallback: –ø–æ–∏—Å–∫ –ø–æ —Å—Ç–∞—Ä–æ–º—É –∏–º–µ–Ω–∏ –∏ —Ü–µ–Ω–µ

---

## üîÑ –û–ë–†–ê–¢–ù–ê–Ø –°–û–í–ú–ï–°–¢–ò–ú–û–°–¢–¨

–í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç –æ–±—Ä–∞—Ç–Ω—É—é —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å:
- –ï—Å–ª–∏ `sync_product_id` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏ –∏ —Ü–µ–Ω–µ
- –ú–∏–≥—Ä–∞—Ü–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç `sync_product_id` –¥–ª—è —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —Ç–æ–≤–∞—Ä–æ–≤
- –°—É—â–µ—Å—Ç–≤—É—é—â–∏–µ —Ç–æ–≤–∞—Ä—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ

---

## üìä –ü–†–ï–ò–ú–£–©–ï–°–¢–í–ê –ù–û–í–û–ì–û –ü–û–î–•–û–î–ê

### ‚úÖ –ù–∞–¥–µ–∂–Ω–æ—Å—Ç—å
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –Ω–µ –∑–∞–≤–∏—Å–∏—Ç –æ—Ç –∏–º–µ–Ω–∏ –∏ —Ü–µ–Ω—ã —Ç–æ–≤–∞—Ä–∞
- –¢–æ–≤–∞—Ä—ã –Ω–∞–¥–µ–∂–Ω–æ —Å–≤—è–∑–∞–Ω—ã —á–µ—Ä–µ–∑ —É–Ω–∏–∫–∞–ª—å–Ω—ã–π ID
- –ù–µ–≤–æ–∑–º–æ–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å –¥—É–±–ª–∏–∫–∞—Ç—ã –ø—Ä–∏ –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–∏

### ‚úÖ –¢–æ—á–Ω–æ—Å—Ç—å
- –û–¥–∏–Ω —Ç–æ–≤–∞—Ä = –æ–¥–∏–Ω `sync_product_id`
- –í—Å–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –∫–æ–ø–∏–∏ –∏–º–µ—é—Ç –æ–¥–∏–Ω–∞–∫–æ–≤—ã–π `sync_product_id`
- –ù–µ—Ç –ø—Ä–æ–±–ª–µ–º —Å —Ç–æ–≤–∞—Ä–∞–º–∏ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∏–º–µ–Ω–µ–º

### ‚úÖ –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –ò–Ω–¥–µ–∫—Å –Ω–∞ `sync_product_id` –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
- –ú–µ–Ω—å—à–µ –∑–∞–ø—Ä–æ—Å–æ–≤ –∫ –ë–î (–æ–¥–∏–Ω –∑–∞–ø—Ä–æ—Å –≤–º–µ—Å—Ç–æ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö)

---

## üß™ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï

### –¢–µ—Å—Ç 1: –°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞ –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ
1. –°–æ–∑–¥–∞—Ç—å —Ç–æ–≤–∞—Ä –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: `sync_product_id = id` —Ç–æ–≤–∞—Ä–∞
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: —Ç–æ–≤–∞—Ä —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω –≤ –º–∞–≥–∞–∑–∏–Ω –±–æ—Ç–∞ —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º `sync_product_id`

### –¢–µ—Å—Ç 2: –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
1. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: —Ç–æ–≤–∞—Ä –ø–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω –≤ –º–∞–≥–∞–∑–∏–Ω–µ –±–æ—Ç–∞ (–ø–æ `sync_product_id`)
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –Ω–µ —Å–æ–∑–¥–∞–Ω –¥—É–±–ª–∏–∫–∞—Ç

### –¢–µ—Å—Ç 3: –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ü–µ–Ω—ã
1. –ò–∑–º–µ–Ω–∏—Ç—å —Ü–µ–Ω—É —Ç–æ–≤–∞—Ä–∞
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: —Ü–µ–Ω–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –≤–æ –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö (–ø–æ `sync_product_id`)

### –¢–µ—Å—Ç 4: –¢–æ–≤–∞—Ä—ã —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∏–º–µ–Ω–µ–º
1. –°–æ–∑–¥–∞—Ç—å –¥–≤–∞ —Ç–æ–≤–∞—Ä–∞ —Å –æ–¥–∏–Ω–∞–∫–æ–≤—ã–º –∏–º–µ–Ω–µ–º, –Ω–æ —Ä–∞–∑–Ω–æ–π —Ü–µ–Ω–æ–π
2. –û–±–Ω–æ–≤–∏—Ç—å –æ–¥–∏–Ω –∏–∑ –Ω–∏—Ö
3. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: –æ–±–Ω–æ–≤–ª–µ–Ω —Ç–æ–ª—å–∫–æ –ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ç–æ–≤–∞—Ä (–ø–æ `sync_product_id`)

### –¢–µ—Å—Ç 5: –£–¥–∞–ª–µ–Ω–∏–µ —Ç–æ–≤–∞—Ä–∞
1. –£–¥–∞–ª–∏—Ç—å —Ç–æ–≤–∞—Ä –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ
2. ‚úÖ –ü—Ä–æ–≤–µ—Ä–∏—Ç—å: —Ç–æ–≤–∞—Ä —É–¥–∞–ª–µ–Ω –≤–æ –≤—Å–µ—Ö –º–∞–≥–∞–∑–∏–Ω–∞—Ö (–ø–æ `sync_product_id`)

---

## üìù –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ü–†–ò–ú–ï–ù–ï–ù–ò–Æ

### –®–∞–≥ 1: –ó–∞–ø—É—Å—Ç–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é

```bash
cd backend
python migrate_add_sync_product_id.py
```

### –®–∞–≥ 2: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç—å —Å–µ—Ä–≤–µ—Ä

```bash
# –û—Å—Ç–∞–Ω–æ–≤–∏—Ç—å —Ç–µ–∫—É—â–∏–π —Å–µ—Ä–≤–µ—Ä (Ctrl+C)
# –ó–∞–ø—É—Å—Ç–∏—Ç—å –∑–∞–Ω–æ–≤–æ
uvicorn app.main:app --reload --host 0.0.0.0 --port 8000
```

### –®–∞–≥ 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Ä–∞–±–æ—Ç—É

1. –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π —Ç–æ–≤–∞—Ä –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –º–∞–≥–∞–∑–∏–Ω–µ
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –≤ –º–∞–≥–∞–∑–∏–Ω–µ –±–æ—Ç–∞
3. –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞—Ç—å —Ç–æ–≤–∞—Ä –∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é
4. –£–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ –¥—É–±–ª–∏–∫–∞—Ç—ã –Ω–µ —Å–æ–∑–¥–∞—é—Ç—Å—è

---

## ‚ö†Ô∏è –í–ê–ñ–ù–´–ï –ó–ê–ú–ï–ß–ê–ù–ò–Ø

1. **–ú–∏–≥—Ä–∞—Ü–∏—è –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–∞** - –±–µ–∑ –Ω–µ–µ –ø–æ–ª–µ `sync_product_id` –Ω–µ –±—É–¥–µ—Ç —Å—É—â–µ—Å—Ç–≤–æ–≤–∞—Ç—å –≤ –ë–î
2. **–û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å** - —Å—Ç–∞—Ä—ã–µ —Ç–æ–≤–∞—Ä—ã –ø—Ä–æ–¥–æ–ª–∂–∞—Ç —Ä–∞–±–æ—Ç–∞—Ç—å —á–µ—Ä–µ–∑ fallback –Ω–∞ –ø–æ–∏—Å–∫ –ø–æ –∏–º–µ–Ω–∏
3. **–ò–Ω–¥–µ–∫—Å** - —Å–æ–∑–¥–∞–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
4. **Foreign Key** - `sync_product_id` —Å—Å—ã–ª–∞–µ—Ç—Å—è –Ω–∞ `products.id`, –Ω–æ –º–æ–∂–µ—Ç –±—ã—Ç—å NULL –¥–ª—è –Ω–æ–≤—ã—Ö —Ç–æ–≤–∞—Ä–æ–≤

---

## üîç –ü–†–û–í–ï–†–ö–ê –í –õ–û–ì–ê–•

–ü–æ—Å–ª–µ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π –≤ –ª–æ–≥–∞—Ö –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å:
- `üîÑ Synced product '...' (id=X, sync_id=Y) to bot Z (CREATE/UPDATE)`
- –í–º–µ—Å—Ç–æ —Å—Ç–∞—Ä–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ –±–µ–∑ `sync_id`

---

**–î–∞—Ç–∞ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:** 2024-12-19  
**–í–µ—Ä—Å–∏—è:** 2.0



